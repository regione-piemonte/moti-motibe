package it.csi.moti.motibe.ejb;

import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;

import com.google.gson.Gson;

import it.csi.moti.motibe.ejb.business.be.service.impl.intervento.PostEsportaListaInterventiService;
import it.csi.moti.motibe.ejb.business.be.service.request.intervento.PostEsportaListaInterventiRequest;
import it.csi.moti.motibe.ejb.business.be.service.response.intervento.PostEsportaListaInterventiResponse;
import it.csi.moti.motibe.lib.dto.intervento.Intervento;
import it.csi.moti.motibe.lib.util.pagination.PagedListImpl;

public class TestExcelListaInterventi {

	public static void main(String[] args) throws IOException {
		String jsonString = "{\"id\":379,\"dataInserimento\":\"2020-11-02T23:00:00.000+0000\",\"dataUltimaModifica\":\"2020-11-12T23:00:00.000+0000\",\"utenteInserimento\":{\"id\":145,\"codiceFiscale\":\"AAAAAA00A11B000J\",\"cognome\":\"21\",\"dataInserimento\":\"2020-11-02T23:00:00.000+0000\",\"flagAccessoSistema\":true,\"nome\":\"Demo\",\"ruolo\":{\"id\":1,\"accessoSistema\":true,\"codRuolo\":\"1\",\"descrizioneRuolo\":\"Unico\"}},\"utenteUltimaModifica\":{\"id\":145,\"codiceFiscale\":\"AAAAAA00A11B000J\",\"cognome\":\"21\",\"dataInserimento\":\"2020-11-02T23:00:00.000+0000\",\"flagAccessoSistema\":true,\"nome\":\"Demo\",\"ruolo\":{\"id\":1,\"accessoSistema\":true,\"codRuolo\":\"1\",\"descrizioneRuolo\":\"Unico\"}},\"attuatore\":\"a4\",\"cig\":\"c41\",\"codIntervento\":\"c40\",\"cup\":\"c4\",\"descrTecnica\":\"desc4\",\"fonteDati\":{\"id\":2,\"descrizione\":\"Nuovo moti\",\"ordine\":2},\"fonteDatiProgrammazione\":\"fffpp4\",\"interventoCostis\":[{\"id\":173,\"dataInserimento\":\"2020-11-12T23:00:00.000+0000\",\"dataUltimaModifica\":\"2020-11-12T23:00:00.000+0000\",\"utenteInserimento\":{\"id\":145,\"codiceFiscale\":\"AAAAAA00A11B000J\",\"cognome\":\"21\",\"dataInserimento\":\"2020-11-02T23:00:00.000+0000\",\"flagAccessoSistema\":true,\"nome\":\"Demo\"},\"utenteUltimaModifica\":{\"id\":145,\"codiceFiscale\":\"AAAAAA00A11B000J\",\"cognome\":\"21\",\"dataInserimento\":\"2020-11-02T23:00:00.000+0000\",\"flagAccessoSistema\":true,\"nome\":\"Demo\"},\"costoPrevisto\":234.00,\"dataUltimaLiquidazione\":\"2020-09-24T22:00:00.000+0000\",\"fonteDati\":\"fff41\",\"fonteRiferimento\":\"ffff4\",\"noteEconomiche\":\"nnneeee444\",\"optlock\":\"00b398f7-4890-479e-9d7d-cd1de8b17838\"}],\"interventoDatiOtis\":[],\"interventoFases\":[{\"id\":611,\"dataInserimento\":\"2020-11-12T23:00:00.000+0000\",\"dataUltimaModifica\":\"2020-11-12T23:00:00.000+0000\",\"utenteInserimento\":{\"id\":145,\"codiceFiscale\":\"AAAAAA00A11B000J\",\"cognome\":\"21\",\"dataInserimento\":\"2020-11-02T23:00:00.000+0000\",\"flagAccessoSistema\":true,\"nome\":\"Demo\"},\"utenteUltimaModifica\":{\"id\":145,\"codiceFiscale\":\"AAAAAA00A11B000J\",\"cognome\":\"21\",\"dataInserimento\":\"2020-11-02T23:00:00.000+0000\",\"flagAccessoSistema\":true,\"nome\":\"Demo\"},\"dataEffettiva\":\"2020-11-28T23:00:00.000+0000\",\"dataPrevista\":\"2020-10-16T22:00:00.000+0000\",\"fase\":{\"id\":1,\"descrizione\":\"Analisi/Studio di fattibilit√†\",\"fonteDati\":{\"id\":1,\"descrizione\":\"Vecchio moti\",\"ordine\":1},\"ordine\":1,\"tipologia\":\"Programmazione\"}},{\"id\":612,\"dataInserimento\":\"2020-11-12T23:00:00.000+0000\",\"dataUltimaModifica\":\"2020-11-12T23:00:00.000+0000\",\"utenteInserimento\":{\"id\":145,\"codiceFiscale\":\"AAAAAA00A11B000J\",\"cognome\":\"21\",\"dataInserimento\":\"2020-11-02T23:00:00.000+0000\",\"flagAccessoSistema\":true,\"nome\":\"Demo\"},\"utenteUltimaModifica\":{\"id\":145,\"codiceFiscale\":\"AAAAAA00A11B000J\",\"cognome\":\"21\",\"dataInserimento\":\"2020-11-02T23:00:00.000+0000\",\"flagAccessoSistema\":true,\"nome\":\"Demo\"},\"dataEffettiva\":\"2020-10-29T23:00:00.000+0000\",\"dataPrevista\":\"2020-09-28T22:00:00.000+0000\",\"fase\":{\"id\":16,\"descrizione\":\"Progetto esecutivo\",\"fonteDati\":{\"id\":2,\"descrizione\":\"Nuovo moti\",\"ordine\":2},\"ordine\":3,\"tipologia\":\"Programmazione\"}},{\"id\":613,\"dataInserimento\":\"2020-11-12T23:00:00.000+0000\",\"dataUltimaModifica\":\"2020-11-12T23:00:00.000+0000\",\"utenteInserimento\":{\"id\":145,\"codiceFiscale\":\"AAAAAA00A11B000J\",\"cognome\":\"21\",\"dataInserimento\":\"2020-11-02T23:00:00.000+0000\",\"flagAccessoSistema\":true,\"nome\":\"Demo\"},\"utenteUltimaModifica\":{\"id\":145,\"codiceFiscale\":\"AAAAAA00A11B000J\",\"cognome\":\"21\",\"dataInserimento\":\"2020-11-02T23:00:00.000+0000\",\"flagAccessoSistema\":true,\"nome\":\"Demo\"},\"dataPrevista\":\"2020-10-16T22:00:00.000+0000\",\"fase\":{\"id\":23,\"descrizione\":\"Progetto esecutivo/Appalto in corso\",\"fonteDati\":{\"id\":3,\"descrizione\":\"OTI\",\"ordine\":3},\"ordine\":4,\"tipologia\":\"Realizzazione\"}}],\"interventoFontefins\":[{\"id\":222,\"dataInserimento\":\"2020-11-12T23:00:00.000+0000\",\"dataUltimaModifica\":\"2020-11-12T23:00:00.000+0000\",\"utenteInserimento\":{\"id\":145,\"codiceFiscale\":\"AAAAAA00A11B000J\",\"cognome\":\"21\",\"dataInserimento\":\"2020-11-02T23:00:00.000+0000\",\"flagAccessoSistema\":true,\"nome\":\"Demo\"},\"utenteUltimaModifica\":{\"id\":145,\"codiceFiscale\":\"AAAAAA00A11B000J\",\"cognome\":\"21\",\"dataInserimento\":\"2020-11-02T23:00:00.000+0000\",\"flagAccessoSistema\":true,\"nome\":\"Demo\"},\"descrizione\":\"DDD\",\"fonteDati\":{\"id\":2,\"descrizione\":\"Nuovo moti\",\"ordine\":2},\"fonteFinanziamento\":{\"id\":1,\"descrizione\":\"U.E.\",\"ordine\":1},\"importoLiquidato\":324.00},{\"id\":223,\"dataInserimento\":\"2020-11-12T23:00:00.000+0000\",\"dataUltimaModifica\":\"2020-11-12T23:00:00.000+0000\",\"utenteInserimento\":{\"id\":145,\"codiceFiscale\":\"AAAAAA00A11B000J\",\"cognome\":\"21\",\"dataInserimento\":\"2020-11-02T23:00:00.000+0000\",\"flagAccessoSistema\":true,\"nome\":\"Demo\"},\"utenteUltimaModifica\":{\"id\":145,\"codiceFiscale\":\"AAAAAA00A11B000J\",\"cognome\":\"21\",\"dataInserimento\":\"2020-11-02T23:00:00.000+0000\",\"flagAccessoSistema\":true,\"nome\":\"Demo\"},\"descrizione\":\"DDD444\",\"fonteDati\":{\"id\":2,\"descrizione\":\"Nuovo moti\",\"ordine\":2},\"fonteFinanziamento\":{\"id\":3,\"descrizione\":\"Regione Piemonte\",\"ordine\":3},\"importoLiquidato\":1234.00}],\"interventoLuogos\":[{\"id\":31,\"dataInserimento\":\"2020-11-12T23:00:00.000+0000\",\"dataUltimaModifica\":\"2020-11-12T23:00:00.000+0000\",\"utenteInserimento\":{\"id\":145,\"codiceFiscale\":\"AAAAAA00A11B000J\",\"cognome\":\"21\",\"dataInserimento\":\"2020-11-02T23:00:00.000+0000\",\"flagAccessoSistema\":true,\"nome\":\"Demo\"},\"utenteUltimaModifica\":{\"id\":145,\"codiceFiscale\":\"AAAAAA00A11B000J\",\"cognome\":\"21\",\"dataInserimento\":\"2020-11-02T23:00:00.000+0000\",\"flagAccessoSistema\":true,\"nome\":\"Demo\"},\"luogo\":{\"id\":849,\"denomLuogo\":\"Alessandria\",\"denomRegione\":\"Piemonte\",\"flagProvincia\":true,\"luogoIstat\":\"006003\",\"regioneIstat\":\"01\",\"sigla\":\"AL\"}}],\"interventoReferentes\":[{\"id\":363,\"utente\":{\"id\":4,\"codiceFiscale\":\"FRNSLV68L48L219Z\",\"cognome\":\"Franchello\",\"dataCancellazione\":\"2015-12-20T23:00:00.000+0000\",\"dataInserimento\":\"2011-12-05T23:00:00.000+0000\",\"dataUltimaModifica\":\"2014-07-24T22:00:00.000+0000\",\"email\":\"silvia.franchello@regione.piemonte.it\",\"flagAccessoSistema\":true,\"nome\":\"Silvia\",\"ruolo\":{\"id\":1,\"accessoSistema\":true,\"codRuolo\":\"1\",\"descrizioneRuolo\":\"Unico\"},\"telefono\":\"011/4322382\"}},{\"id\":364,\"utente\":{\"id\":12,\"codiceFiscale\":\"MRZMRP65B61L219B\",\"cognome\":\"Marzullo\",\"dataCancellazione\":\"2015-12-20T23:00:00.000+0000\",\"dataInserimento\":\"2011-12-05T23:00:00.000+0000\",\"email\":\"mariapia.marzullo@regione.piemonte.it\",\"flagAccessoSistema\":true,\"nome\":\"Maria Pia\",\"ruolo\":{\"id\":1,\"accessoSistema\":true,\"codRuolo\":\"1\",\"descrizioneRuolo\":\"Unico\"},\"telefono\":\"011/4324178\"}},{\"id\":365,\"utente\":{\"id\":16,\"codiceFiscale\":\"MRZLSN69R16A326K\",\"cognome\":\"Marziani\",\"dataCancellazione\":\"2015-12-20T23:00:00.000+0000\",\"dataInserimento\":\"2011-12-05T23:00:00.000+0000\",\"email\":\"alessandro.marziani@regione.piemonte.it\",\"flagAccessoSistema\":true,\"nome\":\"Alessandro\",\"ruolo\":{\"id\":1,\"accessoSistema\":true,\"codRuolo\":\"1\",\"descrizioneRuolo\":\"Unico\"},\"telefono\":\"011/4322066\"}}],\"interventoSituazioneCriticitas\":[{\"id\":230,\"dataInserimento\":\"2020-11-12T23:00:00.000+0000\",\"dataUltimaModifica\":\"2020-11-12T23:00:00.000+0000\",\"utenteInserimento\":{\"id\":145,\"codiceFiscale\":\"AAAAAA00A11B000J\",\"cognome\":\"21\",\"dataInserimento\":\"2020-11-02T23:00:00.000+0000\",\"flagAccessoSistema\":true,\"nome\":\"Demo\"},\"utenteUltimaModifica\":{\"id\":145,\"codiceFiscale\":\"AAAAAA00A11B000J\",\"cognome\":\"21\",\"dataInserimento\":\"2020-11-02T23:00:00.000+0000\",\"flagAccessoSistema\":true,\"nome\":\"Demo\"},\"descrizione\":\"dddd444\",\"fonteDati\":{\"id\":2,\"descrizione\":\"Nuovo moti\",\"ordine\":2},\"situazioneCriticita\":{\"id\":1,\"descrizione\":\"aperta\",\"ordine\":1},\"tipoCriticita\":{\"id\":1,\"descrizioneTipoCriticita\":\"POLITICHE\"}},{\"id\":229,\"dataInserimento\":\"2020-11-12T23:00:00.000+0000\",\"dataUltimaModifica\":\"2020-11-12T23:00:00.000+0000\",\"utenteInserimento\":{\"id\":145,\"codiceFiscale\":\"AAAAAA00A11B000J\",\"cognome\":\"21\",\"dataInserimento\":\"2020-11-02T23:00:00.000+0000\",\"flagAccessoSistema\":true,\"nome\":\"Demo\"},\"utenteUltimaModifica\":{\"id\":145,\"codiceFiscale\":\"AAAAAA00A11B000J\",\"cognome\":\"21\",\"dataInserimento\":\"2020-11-02T23:00:00.000+0000\",\"flagAccessoSistema\":true,\"nome\":\"Demo\"},\"descrizione\":\"h\",\"fonteDati\":{\"id\":2,\"descrizione\":\"Nuovo moti\",\"ordine\":2},\"situazioneCriticita\":{\"id\":1,\"descrizione\":\"aperta\",\"ordine\":1},\"tipoCriticita\":{\"id\":1,\"descrizioneTipoCriticita\":\"POLITICHE\"}},{\"id\":228,\"dataInserimento\":\"2020-11-12T23:00:00.000+0000\",\"dataUltimaModifica\":\"2020-11-12T23:00:00.000+0000\",\"utenteInserimento\":{\"id\":145,\"codiceFiscale\":\"AAAAAA00A11B000J\",\"cognome\":\"21\",\"dataInserimento\":\"2020-11-02T23:00:00.000+0000\",\"flagAccessoSistema\":true,\"nome\":\"Demo\"},\"utenteUltimaModifica\":{\"id\":145,\"codiceFiscale\":\"AAAAAA00A11B000J\",\"cognome\":\"21\",\"dataInserimento\":\"2020-11-02T23:00:00.000+0000\",\"flagAccessoSistema\":true,\"nome\":\"Demo\"},\"descrizione\":\"lllll\",\"fonteDati\":{\"id\":2,\"descrizione\":\"Nuovo moti\",\"ordine\":2},\"situazioneCriticita\":{\"id\":1,\"descrizione\":\"aperta\",\"ordine\":1},\"tipoCriticita\":{\"id\":2,\"descrizioneTipoCriticita\":\"ECONOMICHE/FINANZIARIE\"}}],\"noteProgrammazione\":\"npp4\",\"optlock\":\"848554d6-0c14-4e70-867e-8a9f20639ee6\",\"settore\":{\"id\":4,\"descrizione\":\"Controllo sulla gestione dei trasporti e delle infrastrutture\",\"elemDefault\":0,\"ordine\":4},\"statoAttuaz\":{\"id\":1,\"descrizione\":\"Programmazione\",\"ordine\":1},\"tipologia\":{\"id\":17,\"descrizione\":\"Navigazione\",\"elemDefault\":0,\"ordine\":7},\"titolo\":\"t4444444mod\"}";

		Gson g = new Gson();
		Intervento intervento = g.fromJson(jsonString, Intervento.class);

		List<Intervento> list = new ArrayList<>();
		list.add(intervento);
		
		PagedListImpl<Intervento> pagedList = new PagedListImpl<Intervento>(list);
		PostEsportaListaInterventiRequest request = new PostEsportaListaInterventiRequest(pagedList);

		PostEsportaListaInterventiService service = new PostEsportaListaInterventiService(null, null);
		PostEsportaListaInterventiResponse response = service.execute(request);

		File file = new File("D:\\workspace-moti\\test-lista.xlsx");
		try {
			if (file.exists()) {
				if (!file.delete()) {
					SimpleDateFormat sdf = new SimpleDateFormat("yyyyMMdd-HHmmss");
					file = new File("D:\\workspace-moti\\test-lista" + sdf.format(new Date()) + ".xlsx");
				}
			}
		} catch (Exception e) {
			SimpleDateFormat sdf = new SimpleDateFormat("yyyyMMdd-HHmmss");
			file = new File("D:\\workspace-moti\\test-lista" + sdf.format(new Date()) + ".xlsx");
		}
		
		FileOutputStream fos = new FileOutputStream(file);
		fos.write(response.getBytes());
		fos.close();
		fos = null;
		
		System.out.println("file " + file.getAbsolutePath());
	}

}
